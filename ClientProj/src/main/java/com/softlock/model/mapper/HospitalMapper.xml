<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.softlock.model.HospitalImpl">
	<select id="searchHp" resultType="com.softlock.model.HospListDTO" parameterType="com.softlock.model.HospListDTO">
	     SELECT * FROM hosplist WHERE 1=1 
		 <choose>
		     <when test='hosplist_name == "ㄱ"'>
			    and (hosplist_name LIKE '^(ㄱ|ㄲ)' OR ( hosplist_name <![CDATA[ > ]]>= '가' AND hosplist_name <![CDATA[ < ]]> '나' ))
			 </when>
			 <when test='hosplist_name == "ㄴ"'>
			    and (hosplist_name LIKE '^ㄴ' OR ( hosplist_name <![CDATA[ > ]]>= '나' AND hosplist_name <![CDATA[ < ]]> '다' ))
			 </when>
			 <when test='hosplist_name == "ㄷ"'>
			    and (hosplist_name LIKE '^(ㄷ|ㄸ)' OR ( hosplist_name <![CDATA[ > ]]>= '다' AND hosplist_name <![CDATA[ < ]]> '라' ))
			 </when>
			 <when test='hosplist_name == "ㄹ"'>
			    and (hosplist_name LIKE '^ㄹ' OR ( hosplist_name <![CDATA[ > ]]>= '라' AND hosplist_name <![CDATA[ < ]]> '마' ))
			 </when>
			 <when test='hosplist_name == "ㅁ"'>
			    and (hosplist_name LIKE '^ㅁ' OR ( hosplist_name <![CDATA[ > ]]>= '마' AND hosplist_name <![CDATA[ < ]]> '바' ))
			 </when>
			 <when test='hosplist_name == "ㅂ"'>
			    and (hosplist_name LIKE '^ㅂ' OR ( hosplist_name <![CDATA[ > ]]>= '바' AND hosplist_name <![CDATA[ < ]]> '사' ))
			 </when>
			 <when test='hosplist_name == "ㅅ"'>
			    and (hosplist_name LIKE '^(ㅅ|ㅆ)' OR ( hosplist_name <![CDATA[ > ]]>= '사' AND hosplist_name <![CDATA[ < ]]> '아' ))
			 </when>
			 <when test='hosplist_name == "ㅇ"'>
			     and (hosplist_name LIKE '^ㅇ' OR ( hosplist_name <![CDATA[ > ]]>= '아' AND hosplist_name <![CDATA[ < ]]> '자' ))
			 </when>
			 <when test='hosplist_name == "ㅈ"'>
			    and (hosplist_name LIKE '^(ㅈ|ㅉ)' OR ( hosplist_name <![CDATA[ > ]]>= '자' AND hosplist_name <![CDATA[ < ]]> '차' ))
			 </when>
			 <when test='hosplist_name == "ㅊ"'>
			    and (hosplist_name LIKE '^ㅊ' OR ( hosplist_name <![CDATA[ > ]]>= '차' AND hosplist_name <![CDATA[ < ]]> '카' ))
			 </when>
			 <when test='hosplist_name == "ㅋ"'>
			    and (hosplist_name LIKE '^ㅋ' OR ( hosplist_name <![CDATA[ > ]]>= '카' AND hosplist_name <![CDATA[ < ]]> '타' ))
			 </when>
			 <when test='hosplist_name == "ㅌ"'>
			     and (hosplist_name LIKE '^ㅌ' OR ( hosplist_name <![CDATA[ > ]]>= '타' AND hosplist_name <![CDATA[ < ]]> '파' ))
			 </when>
			 <when test='hosplist_name == "ㅍ"'>
			    and (hosplist_name LIKE '^ㅍ' OR ( hosplist_name <![CDATA[ > ]]>= '파' AND hosplist_name <![CDATA[ < ]]> '하' ))
			 </when>
			 <when test='hosplist_name == "ㅎ"'>
			    and (hosplist_name LIKE '^ㅎ' OR ( hosplist_name <![CDATA[ > ]]>= '하'))
			 </when>
			 <otherwise>
		     	and hosplist_name LIKE '%'||#{hosplist_name}||'%'  
			 </otherwise>
		</choose>
		ORDER BY hosplist_name ASC
	</select>
	
	<select id="login" resultType="com.softlock.model.HospitalDTO" parameterType="String">
      select * from hospital where hp_id=#{0} and hp_pw=#{1}
    </select>
   
	<select id="isUser" resultType="int" parameterType="String">
		select count(*) from hospital
			where hp_id=#{0} and hp_pw=#{1}
	</select>
	
	<!-- 회원탈퇴 -->
	<delete id="delete">
		DELETE FROM hospital WHERE hp_id=#{param1}
	</delete>
	
	<!-- 아이디중복 -->
	<select id="isUserId" resultType="int" parameterType="String">
		select count(*) from hospital
			where hp_id=#{0}
	</select>
	
	<!-- 회원정보 수정폼 진입 -->
	<select id="view" resultType="com.softlock.model.HospitalDTO" >
		SELECT * FROM hospital where hp_id=#{param1}
	</select>
	<!-- 회원정보수정 -->
	<!-- <update id="modifyAction">
	UPDATE hospital SET hp_pw=#{param1}, hp_phone=#{param3}, hp_name=#{param2} WHERE hp_id=#{param4}
	</update> -->
	
	<!-- 회원정보수정 -->
   <update id="modifyAction">
	  	UPDATE hospital(hp_hpphone, hp_night, hp_wkend, hp_intro, hp_notice, hp_image) 
	      SET hp_hpphone=#{param1}, hp_night=#{param2}, hp_wkend=#{param3}, hp_intro=#{param4}, hp_notice=#{param5},
	         hp_image=#{param6},  WHERE hp_id=#{param7}
   </update>
   
   <update id="tmodifyAction">
   		UPDATE treattime (treat_open, treat_close) SET , treat_open=#{param1}, treat_close=#{param2} WHERE hp_idx=#{param3} and treat_dy=#{param4}
   </update>
   
   <insert id="hpJoinAction" parameterType="String">
   		INSERT INTO hospital(hp_idx, hp_id, hp_pw, hp_name, hp_num, hp_username, hp_email, hp_phone, hp_address, hp_address2)
   			VALUES(seq_hospital.nextval , #{param1}, #{param2}, #{param3}, #{param4}, #{param5}, #{param6}, #{param7}, #{param8}, #{param9})
   </insert>
</mapper>